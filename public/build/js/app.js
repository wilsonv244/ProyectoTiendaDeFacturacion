const facturas={id:"",fecha:"",hora:"",cant:"",mercaderia:[]};let stuff=[];const addProducto=document.querySelector("#add-producto"),inputCliente=document.querySelector("#buscarRuc"),inputProducto=document.querySelector("#buscar-producto"),inputNombre=document.querySelector("#nombre-cliente"),inputDireccion=document.querySelector("#direccion-cliente"),inputNumero=document.querySelector("#celular-cliente"),registrarBoleta=document.querySelector("#registrarBoleta"),registrarCantidad=document.querySelector("#cantidad-producto"),listaRecibo=document.querySelector("#lista-recibo"),allInputs=document.querySelectorAll("#formulario input"),inputNombreP=document.querySelector("#nombre-producto"),inputPrecioP=document.querySelector("#precio-producto"),agregarProducto=document.querySelector(".addCompras");function seleccionarInputs(){allInputs.forEach(t=>function(){t.addEventListener("blur",(function(){console.log("Soy un Input...")}))})}document.addEventListener("DOMContentLoaded",(function(){consultarApi(),consultarApiProducto(),registrarCant(),seleccionarInputs(),registrarBoleta.onclick=getBolet}));let i=0;function crearResumenProductos(t){limpiar();t.slice();t.forEach((t,o)=>{const e=document.createElement("TR");e.innerHTML=`\n        <tr>\n        <th>${o}</th>\n        <th>${t.nombre}</th>\n        <th>${cantProducto}</th>\n        <th>${t.precio_venta}</th>\n        <th>${registrarCantidad.value}</th>\n        </tr>`,agregarProducto.appendChild(e)}),console.log("xdxdxd")}function generarValoresRuc(t){inputCliente.addEventListener("blur",(function(o){const e=o.target.value;addDatos(t.filter(t=>e===t.ruc))}))}function addDatos(t){t.length>0?(addCliente(t),console.log(t[0].nombre),inputNombre.value=t[0].nombre,inputDireccion.value=t[0].direccion,inputNumero.value=t[0].numero):(inputNombre.value="",inputDireccion.value="",inputNumero.value="")}function registrarCant(){registrarCantidad.addEventListener("blur",(function(t){cantProducto=t.target.value,facturas.cant=cantProducto}))}let datosM=[];function añadirProductos(t){addProducto.addEventListener("click",(function(){inputNombreP.value="",inputPrecioP.value="",limpiar(),t.forEach(t=>{const o=document.createElement("TR");o.innerHTML=`\n            <tr>\n            <th>${i++}</th>\n            <th>${t.nombre}</th>\n            <th>${cantProducto}</th>\n            <th>${t.precio_venta}</th>\n            <th>${cantProducto*t.precio_venta}</th>\n            </tr>`,agregarProducto.appendChild(o)})})),console.log("hola")}function addCliente(t){let o=(new Date).toISOString().split("T")[0];facturas.id=t[0].id,facturas.fecha=o,facturas.hora=(new Date).toLocaleTimeString()}function generarValoresProducto(t){inputProducto.addEventListener("blur",(function(o){const e=o.target.value,n=t.filter(t=>t.codigo===e);addDatosP(n),stuff=[...stuff,...n],añadirProductos(stuff)}))}function addDatosP(t){console.log(t.length),t.length>0?(inputNombreP.value=t[0].nombre,inputPrecioP.value=t[0].precio_venta):(inputNombreP.value="",inputPrecioP.value="")}async function getBolet(){const{fecha:t,id:o,hora:e,mercaderia:n,cant:r}=facturas,a=n.map(t=>t.id);console.log(a);const c=new FormData;c.append("nombre","wilson Vargas"),c.append("fecha",t),c.append("idcliente",o),c.append("hora",e),c.append("cantidadp",r),c.append("id_producto",a),console.log([...c]);try{const t="http://localhost:3000/api/enviarDatos",o=await fetch(t,{method:"POST",body:c}),e=await o.json();console.log(e)}catch(t){console.log("Hubo un error de conexion")}}async function consultarApi(){try{const t="http://localhost:3000/api/datos",o=await fetch(t),e=await o.json();console.log(e),generarValoresRuc(e)}catch(t){console.log("Error a lconsultar la Api")}}async function consultarApiProducto(){try{const t="http://localhost:3000/api/datosProducto",o=await fetch(t),e=await o.json();generarValoresProducto(e),console.log(e)}catch(t){console.log("hubo un error al traer los productos")}}function limpiar(){for(;agregarProducto.firstChild;)agregarProducto.removeChild(agregarProducto.firstChild)}